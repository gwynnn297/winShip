<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WinShip</title>
    <!-- js slider link -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <!-- font link -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <!-- css link -->
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <header class="header">
        <!-- start header -->
        <a href="home.html" class="logo"><i class="fa-solid fa-bowl-food"></i>winship</a>
        <nav class="navbar">
            <div class="subnav">
                <a href="#" class="subnav-location">Đà Nẵng <i class="fa-solid fa-angle-down"></i></a>
                <ul class="subnav-content">
                    <li><a href="#">Hà Nội</a></li>
                    <li><a href="#">Hồ Chí Minh</a></li>
                    <li><a href="#">Quảng Trị</a></li>
                    <li><a href="#">Đà Lạt</a></li>
                    <li><a href="#">Nha Trang</a></li>
                    <li><a href="#">Hải Phòng</a></li>
                    <li><a href="#">Vũng Tàu</a></li>
                    <li><a href="#">Huế</a></li>
                    <li><a href="#">Cần Thơ</a></li>
                </ul>
            </div>
            <a class="navbar-hover-firt-item" href="./restaurants.html#display-row">Thử Quán Mới</a>
            <a href="./restaurants.html#on-sale">Đang Khuyến Mãi</a>
            <a href="./restaurants.html#familiar-brand">Thương Hiệu Quen Thuộc</a>
            <a href="./restaurants.html#near-store">Cửa Hàng Gần Bạn</a>
            <a href="./restaurants.html#recently-booked">Vừa Đặt Gần Đây</a>
        </nav>
        <div class="icons">
            <i class="fas fa-bars" id="menu-bars"></i>
            <i class="fas fa-search" id="search-icon"></i>
            <a href="#" class="fas fa-shopping-cart"></a>
        </div>
        <div class="login">
            <a href="#" class="login-btn">Đăng Nhập</a>
        </div>
    </header>
    <!-- start header -->

      <!-- end cart -->
    <div class="select-details">
           
        <section class="cart">
            <i class="fa-solid fa-circle-xmark"></i>
            <h2>Cart</h2>
            <form action="">
                <table>
                    <thead>
                        <tr>
                            <th>Món ăn</th>
                            <th>Giá</th>
                            <th>SL</th>
                            <th>Chọn</th>
                        </tr>
                    </thead>
                    <tbody>

                    </tbody>

                </table>

                <div style="text-align: right;" class="price-total">
                    <p class="total" style="font-weight: bold;">Tổng tiền :<span>0</span><sup>đ</sup></p>

                </div>
                <div class="oder-close"> </div>
                <a href="./thanhtoan.html"class="close-oder">Chốt đơn </a>
            </form>
        </section>
    
    </div>

     <!-- cart -->

    <!-- start form -->
    <form action="" id="search-form">
        <input type="search" placeholder="search here..." id="search-box">
        <label for="search-box" class="fas fa-search"></label>
        <i class="fas fa-times" id="close"></i>
    </form>


    <!--content-->

    <div class="container-pay">
        <h1><i class="fa-solid fa-circle-dollar-to-slot"></i> Bước cuối cùng - Thanh toán <i
                class="fa-solid fa-circle-dollar-to-slot"></i></h1>
        <div class="content-pay">

            <div class="content-give">
                <h4>Giao đến</h4>
                <p>Thời gian giao hàng đến</p>
                <h2>25 phút <i class="fa-regular fa-clock"></i>5,6 km<i class="fa-solid fa-road"></i></h2>

                <div class="address-container">
                    <div class="address-image">
                        <img src="images/ảnh duy tân.png" alt="Map" />
                    </div>
                    <div class="address-info">
                        <h5>Địa chỉ</h5>
                        <input type="text" value="120 Hoàng Minh Thảo, Hoà Khánh Nam, Liên Chiểu, Đà Nẵng 550000"
                            readonly />

                        <h3>Chi tiết địa chỉ</h3>
                        <textarea rows="2"
                            placeholder="120 Hoàng Minh Thảo, Hoà Khánh Nam, Liên Chiểu, Đà Nẵng 550000"></textarea>

                        <h5>Ghi chú cho tài xế</h3>
                            <textarea rows="2" placeholder="Hãy gặp tôi tại sảnh"></textarea>
                    </div>
                </div>
            </div>


        </div>

        <div class="order-summary">
            <h3>Tóm tắt đơn hàng</h3>
            <div class="order-items-container">
                <!-- Các món sẽ được thêm động tại đây -->
            </div>
            <div class="total-cost">
                <p><span>Tạm tính</span><span id="total-price">0 đ</span></p>
                <p><span>Phí vận chuyển</span><span>29,000 đ</span></p>
            </div>
        </div>
        

        <!--chi tiết thanh toán-->
        <div class="payment-details">
            <h2>Chi tiết thanh toán</h2>
            <div class="Payment-method">
                <h5>Phương thức thanh toán</h5>
                <select class="filter-select">
                    <option value="">Tiền mặt</option>
                    <option value="food">Momo</option>
                    <option value="beverages">Tài khoảng ngân hàng</option>
                </select>

            </div>


        </div>

        <!--Khuyến mãi-->
        <div class="promo-entry">
            <h2>Khuyến mãi</h2>
            <div class="content-price-code">
                <textarea id="promo-code" rows="2" placeholder="Mã khuyến mãi"></textarea>
                <button id="apply-button" class="apply-button">Áp dụng</button>
            </div>
            <div class="promo-details">
                <p>Giảm 7K, thêm ưu đãi bên dưới</p>
                <p>Promo Code: <span id="promo-code-text">MFPSLNMM</span></p>
                <div class="promo-validity">
                    <p>Valid 2024-09-30 to 2024-12-30</p>
                    <button id="apply-button2">APPLY</button>
                </div>
            </div>
        </div>


        <!--footer-->
        <footer class="footer-pay">
            <div class="footer-content-pay">
                <p><strong>Tổng cộng:</strong><span id="final-total-pay">128.000</span></p>
            </div>
            <a href="./delivery.html" class="order-button-pay">Đặt đơn</a>
        </footer>







        <div class="overlay"></div>

<script>
//hiển thị món ăn đã chọn
    document.addEventListener("DOMContentLoaded", function () {
    const orderContainer = document.querySelector(".order-items-container");
    const totalPriceElement = document.getElementById("total-price");

    // Lấy dữ liệu từ Local Storage
    const cart = JSON.parse(localStorage.getItem("cart")) || [];

    // Hàm render giỏ hàng
    function renderCart() {
        let total = 0; // Tổng giá trị đơn hàng
        orderContainer.innerHTML = ""; // Xóa nội dung cũ

        // Lặp qua các món trong Local Storage
        cart.forEach((item) => {
            // Tạo phần tử HTML cho từng món
            const orderItem = document.createElement("div");
            orderItem.classList.add("order-item");
            orderItem.innerHTML = `
                <img src="${item.img}" alt="${item.name}" style="width: 50px; height: 50px;">
                <span>${item.name}</span>
                <span>Số lượng: ${item.quantity}</span>
                <h6>${(item.price * item.quantity).toLocaleString('vi-VN')} đ</h6>
            `;
            orderContainer.appendChild(orderItem);

            // Cộng tổng tiền
            total += item.price * item.quantity;
        });

        // Hiển thị tổng tiền
        totalPriceElement.textContent = total.toLocaleString("vi-VN") + " đ";
    }

    // Gọi hàm để render dữ liệu
    renderCart();
});



//tổng cộng tiền
document.addEventListener('DOMContentLoaded', function () {
    // Giá trị tạm tính và phí vận chuyển
    const temporaryTotalElement = document.querySelector("#total-price"); // Phần tử chứa giá trị tạm tính
    const finalTotalElement = document.querySelector("#final-total-pay"); // Phần tử chứa tổng cộng

    const shippingFee = 29000; // Phí vận chuyển (29,000)

    function calculateFinalTotal() {
        // Lấy giá trị tạm tính (loại bỏ ký tự không phải số và chuyển sang số nguyên)
        const temporaryTotal = parseInt(temporaryTotalElement.textContent.replace(/\D/g, ""));
        
        // Tính tổng cộng
        const finalTotal = temporaryTotal + shippingFee;

        // Cập nhật tổng cộng vào phần tử
        finalTotalElement.textContent = finalTotal.toLocaleString('vi-VN') + " đ";
    }

    // Tính tổng cộng ngay khi trang được tải
    calculateFinalTotal();
});



//mã khuyến mãi
document.addEventListener("DOMContentLoaded", function () {
    const promoCodeText = document.querySelector("#promo-code-text").textContent; // Mã khuyến mãi
    const promoCodeInput = document.querySelector("#promo-code"); // Ô nhập mã khuyến mãi
    const applyButton = document.querySelector("#apply-button"); // Nút "Áp dụng"
    const applyButton2 = document.querySelector("#apply-button2"); // Nút "APPLY" trong phần promo
    const finalTotalElement = document.querySelector("#final-total-pay"); // Tổng cộng
    const originalTotal = parseInt(finalTotalElement.textContent.replace(/\D/g, "")); // Lấy giá trị ban đầu
    let discountApplied = false; // Trạng thái đã áp dụng mã khuyến mãi

    // Khi nhấn nút "APPLY" để tự động điền mã vào ô nhập mã khuyến mãi
    applyButton2.addEventListener("click", function () {
        promoCodeInput.value = promoCodeText; // Gán mã khuyến mãi vào ô nhập
    });

    // Khi nhấn nút "Áp dụng"
    applyButton.addEventListener("click", function () {
        if (!discountApplied) {
            const inputCode = promoCodeInput.value.trim(); // Lấy giá trị từ ô nhập
            if (inputCode === promoCodeText) {
                // Kiểm tra mã có hợp lệ không
                discountApplied = true; // Đánh dấu mã đã áp dụng
                const discountedTotal = originalTotal - 7000; // Tính tổng sau khi giảm 7K
                finalTotalElement.textContent = discountedTotal.toLocaleString("vi-VN") + " đ";

                // Chuyển nút "Áp dụng" thành "Xóa"
                applyButton.textContent = "Xóa";
                applyButton.classList.add("remove-button");
            } else {
                alert("Mã khuyến mãi không hợp lệ!"); // Thông báo mã không hợp lệ
            }
        } else {
            // Khi nhấn vào nút "Xóa"
            discountApplied = false; // Hủy trạng thái áp dụng mã
            finalTotalElement.textContent = originalTotal.toLocaleString("vi-VN") + " đ"; // Trả tổng cộng về giá trị cũ
            applyButton.textContent = "Áp dụng"; // Đổi nút thành "Áp dụng"
            applyButton.classList.remove("remove-button");
            promoCodeInput.value = ""; // Xóa nội dung trong ô nhập
        }
    });
});
</script>

        <!-- js link -->
        <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
        <script src="js/script.js"></script>
</body>

</html>